# iPod风格音乐播放器 MVP 产品方案

## 1. 产品概述

### 1.1 产品概念
基于经典iPod设计的iOS音乐播放器，集成Spotify服务，通过复古转盘操作提供沉浸式音乐体验。

### 1.2 核心价值主张
- **怀旧体验**：经典iPod操作体验的数字重现
- **专注播放**：简约而专注的音乐播放体验  
- **现代融合**：与Spotify生态的完美结合

## 2. 用户交互设计

### 2.1 界面结构设计

**主界面结构**
应用包含以下主要页面：

- **主页 (Home)**：包含Playlist、Settings、User三个主要入口
- **Playlist**：展示Playlist的界面，以Album形式展示，点击后进入Playing界面
- **Now Playing**：展示歌曲封面和播放进度的播放界面
- **Settings**：包含Themes和Upgrade to Pro两个选项
- **Themes**：改变不同风格的iPod样式
- **Upgrade**：购买界面

### 2.2 应用启动流程
```
用户打开应用 → 进入主页界面

首次使用场景：
显示主页界面 → 点击Playlist → 触发Spotify授权 → 授权后加载音乐库 → 进入Playlist浏览

再次使用场景：
显示主页界面 → 点击Playlist → 直接进入音乐库
```

### 3.4 权限处理策略

**延迟权限申请**
- 应用启动时不主动申请权限
- 仅当用户主动播放时才请求权限
- 提供清晰的权限说明和引导

**权限状态处理**
- **未授权**：显示Playlist界面时触发Spotify授权申请
- **已授权**：正常显示音乐内容和播放控制
- **权限拒绝**：提供设置跳转引导

## 4. 界面设计规范

> **设计参考文件**: `doc/design/reference/design.json`

### 4.1 整体布局结构
```
┌─────────────────────────┐
│                         │
│      屏幕区域 (50%)       │
│   ┌─────────────────┐   │
│   │   专辑封面      │   │  ← 200x200pt
│   │   歌曲标题      │   │
│   │   艺术家名称    │   │
│   │   播放进度条    │   │
│   │   状态提示      │   │
│   └─────────────────┘   │
│                         │
├─────────────────────────┤
│                         │
│    转盘控制区 (50%)      │
│       ┌─────┐           │
│       │ ↑   │           │  ← 转盘直径: 屏幕宽度70%
│       │← ● →│           │  ← 中央按钮: 转盘直径35%
│       │ ↓   │           │
│       └─────┘           │
└─────────────────────────┘
```

### 4.2 视觉设计语言

**色彩方案 (参考 design.json)**
- **背景色 (background)**：`#FFFFFF`
- **文本颜色 (text)**：`#000000`
- **高亮背景 (highlightBackground)**：`#3478F6`
- **高亮文本 (highlightText)**：`#FFFFFF`
- **分割线 (divider)**：`#C8C7CC`

**字体层级 (参考 design.json)**
- **字体家族**：Helvetica Neue
- **歌曲标题**：18pt，常规
- **艺术家信息**：14pt，常规
- **菜单项**：18pt，加粗
- **辅助信息**：12pt，常规

**圆角和阴影**
- **屏幕区域**：10pt圆角，轻微阴影
- **按钮元素**：4pt圆角
- **转盘**：完全圆形，渐变阴影效果

### 4.3 状态设计

**播放状态指示**
- **未播放**：显示播放图标，专辑封面静态
- **播放中**：显示暂停图标，专辑封面静态显示
- **加载中**：显示加载动画，禁用操作
- **错误状态**：显示重试提示

**首次使用引导**
- 在屏幕区域底部显示操作提示文字
- 使用淡入淡出动画吸引注意
- 用户首次操作后自动隐藏

### 4.4 状态栏设计

状态栏位于屏幕区域顶部，用于显示关键信息。
```
┌─────────────────────────┐
│ Page Title      🔋      │  ← 左侧为页面标题，右侧为复古电池图标
└─────────────────────────┘
```
- **内容**：左侧显示当前页面标题，右侧显示一个复古风格的电池电量图标。
- **样式**：遵循 `design.json` 中 `statusBar` 的定义。

## 5. 交互体验设计

### 5.1 手势识别规则

**旋转手势参数**
- **最小识别角度**：15度
- **音量调节敏感度**：每30度调节1级
- **切歌触发阈值**：连续旋转90度
- **手势重置时间**：2秒无操作后重置状态

**触觉反馈设计**
- **轻微旋转**：轻量级震动反馈
- **切歌操作**：中等强度震动
- **按钮点击**：清脆的点击反馈
- **音量调节**：渐进式反馈强度

### 5.2 动画效果设计

**专辑封面动画**
- **静态状态**：无动画，显示完整封面
- **播放状态**：静态显示，保持完整封面清晰可见
- **切换歌曲**：淡出旧封面，淡入新封面

**转盘反馈动画**
- **旋转操作**：转盘跟随手指旋转
- **按压效果**：中央按钮按下时缩放效果
- **操作反馈**：短暂的高亮提示

**进度条动画**
- **播放进度**：平滑的进度填充动画
- **手动调节**：实时响应用户操作
- **缓冲状态**：渐变加载动画

### 5.3 错误处理设计

**网络连接问题**
- 显示网络错误提示
- 提供重试按钮
- 支持离线已缓存内容播放

**权限拒绝处理**
- 显示友好的权限说明
- 提供设置页面跳转
- 保持应用可用性，显示功能限制说明

**内容加载失败**
- 显示加载失败提示
- 自动尝试重新加载
- 提供手动刷新选项

## 6. 技术架构概览

### 6.1 核心技术栈
- **UI框架**：SwiftUI (iOS 15.0+)
- **音频服务**：Spotify SDK
- **手势处理**：自定义SwiftUI手势识别
- **状态管理**：Combine + ObservableObject
- **本地存储**：UserDefaults (用户偏好)

### 6.2 系统架构设计
```
┌─────────────────┐
│   SwiftUI Views │  ← 用户界面层
├─────────────────┤
│  State Manager  │  ← 状态管理层
├─────────────────┤
│  Music Service  │  ← 业务逻辑层
├─────────────────┤
│   Spotify SDK   │  ← Spotify服务层
└─────────────────┘
```

### 6.3 数据流设计
```
用户操作 → 手势识别 → 状态更新 → 音乐服务 → Spotify API
    ↑                                                 ↓
UI更新 ← 状态通知 ← 播放反馈 ← 音频回调 ←─────────────────┘
```



## 9. 详细界面功能设计

### 9.1 主页界面 (Home Page)

**界面结构**
```
┌─────────────────────────┐
│       lovepod           │  ← 应用标题栏
├─────────────────────────┤
│ ┌──────────┬──────────┐ │
│ │  菜单列表 │ 图标预览  │ │  ← 分屏布局
│ │          │          │ │
│ │▶ Playlist│   🎵     │ │  ← 选中项高亮
│ │  Settings│   ⚙️     │ │
│ │  User    │   👤     │ │
│ │          │          │ │
│ └──────────┴──────────┘ │
├─────────────────────────┤
│    转盘控制区 (50%)      │
│       ┌─────┐           │
│       │MENU │           │
│       │◀ ● ▶│           │
│       │PLAY │           │
│       └─────┘           │
└─────────────────────────┘
```

**功能说明**
- **主要入口**：提供三个核心功能入口
- **可视化导航**：左侧文字菜单，右侧图标预览
- **选中状态**：当前选中项用箭头和高亮显示
- **快速预览**：右侧显示对应功能的图标或预览

**iPod Classic交互操作**
- **转盘旋转**：顺时针/逆时针旋转选择上下菜单项
- **中央按钮点击**：确认进入选中的功能页面
- **MENU按钮**：无操作（已在主页）
- **触觉反馈**：每切换一个菜单项时轻微震动

### 9.2 Playlist界面

**界面结构**
```
┌─────────────────────────┐
│      Cover Flow         │  ← 页面标题
├─────────────────────────┤
│                         │
│   / Album / [ Album ] \ Album \   │  ← 横向封面流 (Cover Flow)
│                         │
│       Playlist Name       │  ← 播放列表名称
│                         │
├─────────────────────────┤
│    转盘控制区 (50%)      │
│       ┌─────┐           │
│       │MENU │           │
│       │◀ ● ▶│           │
│       │PLAY │           │
│       └─────┘           │
└─────────────────────────┘
```

**功能说明**
- **播放列表展示**：以横向封面流 (Cover Flow) 形式展示用户的Spotify播放列表。
- **高亮显示**：屏幕中央高亮显示当前选中的播放列表封面及其名称。
- **状态指示**：显示播放列表歌曲数量和时长信息。

**iPod Classic交互操作**
- **转盘旋转**：左右滚动切换播放列表
- **中央按钮点击**：进入选中播放列表的歌曲列表
- **MENU按钮**：返回主页 (Home Page)
- **PLAY/PAUSE按钮**：立即播放选中的播放列表（从第一首开始）
- **触觉反馈**：选择切换时震动，确认选择时加强震动

### 9.3 Now Playing界面

**界面结构**
```
┌─────────────────────────┐
│     Now Playing         │  ← 页面标题
├─────────────────────────┤
│                         │
│   ┌─────────────────┐   │
│   │                 │   │  ← 专辑封面 (200x200pt)
│   │   [Album Art]   │   │
│   │                 │   │
│   └─────────────────┘   │
│                         │
│    Song Title Here      │  ← 歌曲标题
│    Artist Name          │  ← 艺术家
│    Album Name           │  ← 专辑名称
│                         │
│  ▓▓▓▓▓▓▓░░░░░░░░░░░    │  ← 播放进度条 (Scrubbing)
│  1:23 / 3:45            │  ← 时间显示
├─────────────────────────┤
│    转盘控制区 (50%)      │
│       ┌─────┐           │
│       │⏯ ● ⏭│           │  ← 播放/暂停，下一首
│       │MENU │           │  ← 菜单
│       └─────┘           │
└─────────────────────────┘
```

**功能说明**
- **专辑封面显示**：居中显示当前播放歌曲的专辑封面
- **歌曲信息**：显示歌曲标题、艺术家、专辑名称
- **播放进度**：实时显示播放进度条和时间
- **播放控制**：提供播放/暂停、上下曲切换功能

**iPod Classic交互操作**
- **转盘旋转**：快进/快退播放进度 (Scrubbing)
- **中央按钮点击**：播放/暂停切换
- **左右按钮**：上一首/下一首歌曲
- **MENU按钮**：返回Playlist界面或主页
- **长按中央按钮**：收藏当前歌曲或显示更多选项
- **长按MENU + 转盘旋转**：调节音量大小

### 9.4 Settings界面

**界面结构**
```
┌─────────────────────────┐
│       Settings          │  ← 页面标题
├─────────────────────────┤
│ ┌──────────┬──────────┐ │
│ │ 设置选项  │   预览    │ │
│ │          │          │ │
│ │▶ Themes  │   🎨     │ │  ← 主题设置
│ │  Upgrade │   💎     │ │  ← 升级Pro
│ │  About   │   ℹ️     │ │  ← 关于信息
│ │  Privacy │   🔒     │ │  ← 隐私设置
│ │          │          │ │
│ └──────────┴──────────┘ │
├─────────────────────────┤
│    转盘控制区 (50%)      │
│       ┌─────┐           │
│       │MENU │           │
│       │◀ ● ▶│           │
│       │ SEL │           │
│       └─────┘           │
└─────────────────────────┘
```

**功能说明**
- **主题设置入口**：进入iPod样式主题选择
- **升级Pro功能**：购买高级功能的入口
- **应用信息**：显示版本、开发者信息等
- **隐私设置**：管理数据权限和隐私选项

**iPod Classic交互操作**
- **转盘旋转**：上下选择设置选项
- **中央按钮点击**：进入选中的设置页面
- **MENU按钮**：返回主页
- **触觉反馈**：选择时轻微震动

### 9.5 Themes界面

**界面结构**
```
┌─────────────────────────┐
│        Themes           │  ← 页面标题
├─────────────────────────┤
│ ┌──────────┬──────────┐ │
│ │ 主题列表  │ 预览效果  │ │
│ │          │          │ │
│ │▶ Classic │[iPod预览]│ │  ← 经典白色iPod
│ │  Black   │[黑色预览]│ │  ← 黑色版本
│ │  Retro   │[复古预览]│ │  ← 复古配色
│ │  Neon    │[霓虹预览]│ │  ← 霓虹色彩
│ │  Custom  │[自定义] │ │  ← 用户自定义
│ └──────────┴──────────┘ │
├─────────────────────────┤
│    转盘控制区 (50%)      │
│       ┌─────┐           │
│       │MENU │           │
│       │◀ ● ▶│           │
│       │APPLY│           │
│       └─────┘           │
└─────────────────────────┘
```

**功能说明**
- **主题预览**：实时预览不同iPod样式的视觉效果
- **多种选择**：经典、现代、复古等多种风格
- **即时应用**：选择后立即应用到整个应用
- **自定义选项**：允许用户自定义配色方案

**iPod Classic交互操作**
- **转盘旋转**：浏览不同主题选项
- **中央按钮点击**：应用选中的主题
- **右侧预览**：实时显示主题效果
- **MENU按钮**：返回Settings界面
- **确认震动**：应用主题时提供确认反馈

### 9.6 Upgrade界面

**界面结构**
```
┌─────────────────────────┐
│     Upgrade to Pro      │  ← 页面标题
├─────────────────────────┤
│                         │
│   🎵 Premium Features   │
│                         │
│   ✓ 无广告播放          │  ← Pro功能列表
│   ✓ 解锁高级主题        │
│   ✓ 屏幕保持常亮        │
│   ✓ 支持后台播放        │
│   ✓ 自定义触觉反馈      │
│                         │
│   ───────────────────   │
│                         │
│     ¥30/月 或 ¥298/年    │  ← 价格信息
│                         │
├─────────────────────────┤
│    转盘控制区 (50%)      │
│       ┌─────┐           │
│       │MENU │           │
│       │◀ ● ▶│           │
│       │ BUY │           │
│       └─────┘           │
└─────────────────────────┘
```

**功能说明**
- **功能展示**：清晰列出Pro版本的增值功能
- **价格选择**：提供月付和年付两种选项
- **购买流程**：集成App Store内购流程
- **恢复购买**：支持已购买用户的账户恢复

**iPod Classic交互操作**
- **转盘旋转**：选择月付/年付方案
- **中央按钮点击**：确认购买选中方案
- **MENU按钮**：返回Settings界面
- **长按中央按钮**：恢复购买记录
- **购买确认**：系统内购确认流程

---

*文档版本：v1.2 (交互优化版)*  
*更新日期：2025年7月12日*